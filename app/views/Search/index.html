#{extends viewUtils.themeProperty('themeLayout') /}

#{set title:'Search results' /}

#{set 'moreCss'}
<link rel="stylesheet" type="text/css" media="screen" href="@{'/public/themes/common/stylesheets/facets/facets.css'}"/>
#{/set}

#{set 'moreScripts'}
<script src="@{'/public/themes/common/javascripts/results.js'}" type='text/javascript'></script>
#{/set}

#{breadcrumbs /}

*{
<div>
    getPageNumber: ${pagination.getPageNumber()}<br/>
    getStart: ${pagination.getStart()}<br/>
    getRows: ${pagination.getRows()}<br/>
    getNexPage: ${pagination.getNextPage()}<br/>
    getPreviousPage: ${pagination.getPreviousPage()}</br/>
    getQueryForPresentation: ${pagination.getPresentationQuery().getQueryForPresentation()}<br/>
    getNumFound(): ${pagination.getNumFound()}<br/>

    paginationLink: /search?${pagination.getPresentationQuery().getQueryForPresentation()}&start=${pagination.getStart()}

</div>
}*
<div class="g-12of12">
    <div class="item-count">
        &{'search.trail', pagination.getStart(), pagination.getRows() + pagination.getStart(), pagination.getNumFound() }
        <ul class="breadcrumb">
            #{list pagination.getBreadcrumbs(), as: 'crumb'}
            #{ifnot crumb_isLast}
            <li><a href="@{Search.index()}?${crumb.href()}"><span>${crumb.value().shorten(50)}</span></a></li>
            #{/ifnot}
            #{else}
            <li><span>${crumb.value()}</span></li>
            #{/else}
            #{/list}
        </ul>
    </div>
</div>

<div class="row">
    <div class="g-8of12">
        #{if pagination.getNumFound() > views.context.package.PAGE_SIZE()}
        <div class="pager mbl">
            #{resultPagination pageLinks: pagination, pQuery: pagination.getPresentationQuery().getQueryForPresentation() /}
        </div>
        #{/if}
        <div class="results">
            #{if briefDocs }
            #{resultGrid results: briefDocs /}
            #{/if}
            #{else}
            &{'ui.message.nothingFound'}
            #{/else}
        </div>
        #{if pagination.getNumFound() > views.context.package.PAGE_SIZE()}
        <div class="pager">
            #{resultPagination pageLinks: pagination, pQuery: pagination.getPresentationQuery().getQueryForPresentation() /}
        </div>
        #{/if}
    </div>
    <div class="g-4of12">
        <div class="mod facets">
            <div class="inner">
                <div class="hd"><h3>&{'search.refineYourSearchBy'}:</h3></div>
                <div class="bd">
                    #{facet facetMap: facets, type: "europeana_provider_facet", typeKey: viewUtils.getKey('search.facet.byProvider'), qString: pagination.getPresentationQuery().getUserSubmittedQuery() /}
                    #{facet facetMap: facets, type: "europeana_year", typeKey: viewUtils.getKey('search.facet.byYear'), gClass:"g-1of2", qString: pagination.getPresentationQuery().getUserSubmittedQuery() /}
                </div>
            </div>
        </div>
        *{
        TODO: find a way to keep dropped items in here while paging!
        }*
        #{if userName}
        <div id="dropbox" class="widget color-green">
            <div class="widget-head"><h3>Collection Cart</h3></div>
            <div class="widget-content">
                <div id="dropbox-info" class="ui"><p>Drop items here</p></div>
                <form action="" method="post">
                    <ul>

                    </ul>
                    <div id="dropbox-actions">
                        <select id="collections">
                            <option value="col1">Collection1</option>
                            <option value="col2">Collection2</option>
                            <option value="col3">Collection3</option>
                        </select>
                        <input type="submit" value="Add items to collection"/>
                    </div>
                </form>

            </div>
        </div>
            #{/if}
            *{ <!-- commented out for now until functionality is there -->
            <div class="dropdown">
                #{btnHref label: viewUtils.getKey('search.sortby'), toggle:true/}
                <div class="dropdown-slider">
                    <a href="#" class="ddm"><span class="label">&{'thing.object'}</span></a>
                    <a href="#" class="ddm"><span class="label">&{'thing.collection'}</span></a>
                </div>
            </div>
            }*
        </div>

    </div>

    <!-- overlayed element -->
    <div id="overlay" class="result-overlay">
        <!-- the external content is loaded inside this tag -->
        <div class="contentWrap"></div>
    </div>


