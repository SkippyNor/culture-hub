@(spec: String, factDefinitions: Seq[controllers.FactDefinition])

@import views.context._
@import views.tags.html._

@main("Update facts") {

<div class="grid_8">

  <form id="factsForm" method="post" action="">
    @for(factDef <- factDefinitions) {
      @if(factDef.hasOptions) {
        @populatedSelectField(factDef.name + "_field", factDef.prompt, factDef.options.map(opt => (opt, opt)), "value: " + factDef.name, factDef.tooltip)
      } else {
        @textField(factDef.name + "_field", factDef.prompt, "value: " + factDef.name, factDef.tooltip, factDef.automatic)
      }
    }

    <div class="field">
        <div class="inputs">
        <input id="saveButton" type="submit" value="Save Facts" />
        </div>
    </div>
    
  </form>

</div>
<script type="text/javascript">
  $(document).ready(function() {
    var factsModel = {};
    var scope = document.getElementById('factsForm');

    $('#saveButton').click(function(event) {
      event.preventDefault();
      $.postKOJson('/@userName/dataset/@spec/facts', factsModel, function(data) {
          updateViewModel(data, factsModel, scope);
          window.location.href = '/@userName/dataset/@spec/facts'
      }, function(jqXHR, textStatus, errorThrown) {
        $('#result').html('Error saving facts, please try again');
        $('#result').show().fadeOut('3000');
      })
    });

    load('/@userName/dataset/@spec/facts', factsModel, scope);
  })
</script>
}