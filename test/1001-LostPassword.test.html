#{fixture 'test.TestDataLoader' /}

#{selenium '1000 - New user registration'}
  clearSession()

  open('/registration/lostPassword')

  # Validation on e-mail to recover
  type('email','wrongEmail')
  clickAndWait('css=input[type=submit]')
  verifyTextPresent(' Invalid email address')
  type('email','nonExistant@email.com')
  clickAndWait('css=input[type=submit]')
  verifyTextPresent('No account could be found with this email address')

  type('email','bob@gmail.com')
  clickAndWait('css=input[type=submit]')
  verifyTextPresent('An e-mail has been sent to you with a link to reset your password ')

  open('/registration/resetPassword/testResetPasswordToken')

  # Validation on password
  clickAndWait('css=input[type=submit]')
  verifyTextPresent(' Required')
  type('password1','a')
  type('password2','b')
  clickAndWait('css=input[type=submit]')
  verifyTextPresent(' Passwords are not the same')

  type('password2','a')
  clickAndWait('css=input[type=submit]')
  verifyTextPresent('Your password has been successfully changed ')
#{/selenium}